# Computer Networking (COM2022)

*How does the Internet work?*

* Protocol: A way of communicating between multiple devices in a standardised manner
* Several layers of protocols and communication (OSI Model)
  * High level protocols (application layer) - HTTP, SMTP
  * Middle level protocols (network layer) - TCP/IP (TCP/UDP), ARP, DHCP
  * Low level protocols (transmission layer) - Ethernet, WiFi, ADSL, 3G/4G

### What does a network need to do?

* Ensure hosts **do not transmit at the same time**
* Establish **rules** to ensure that each host gets **fair access to the network**
* Have **protocols** to **route data efficiently** around the network, **minimising transmission time and wait periods**
* An **address** scheme to **uniquely identify** hosts

### Key aspects of networking

* **Data communication**: signals over wires
* **Networks**: packets over bits
* **Internet**: datagrams over packets
* **Network programming**: application data over the Internet
* **Cross functional concepts and technologies**: network configuration, control and management

#### Two key properties that protocols specify: Syntax and Semantics

* Syntax: format of messages, representation of data, encoding of signals
* Semantics: meaning of messages, procedures for exchanging messages, error handling

Protocols interact with each other in defined layers, because communication is complicated:

* ISO defines a **7-layer** model
* Internet protocols use a **5-layer** reference model

### Internet Reference Model

![Internet model](https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2F3.bp.blogspot.com%2F-RhIT1iNmpnI%2FU6AEoZ43AYI%2FAAAAAAAAAWk%2FAixlvqoma_A%2Fs1600%2Ftcp-ip-layers.jpg&container=blogger&gadget=a&rewriteMime=image%2F*)

![TCP Header](http://www.insecure.in/images/TCP-Header.png)



## Description of layers

### Physical Layer

* Underlying transmission
* Multiplexing/demultiplexing
* Electrical properties, like radio frequencies and voltages
* Associated hardware

### Network Interface Layer

* Communication between a computer and its network hardware
* Datalink/MAC layer
* Hardware (MAC) addressing
* Packet formats
* Error detection

### Internet Layer

* Communication between a pair of computers over the Internet
* Internet packet format
* Internet addressing model (IPv4/IPv6) and address assignment
* Forwarding/masquerade of packets
* Dividing an Internet packet into smaller packets for transmission
* More error detection

### Transport layer

* Communication between a pair of applications
* Demultiplexing among multiple destinations on one computer
* Reliable delivery/retransmission
* Controls data rate and avoids congestion

### Application Layer

* Format and representation of data and messages
* Procedures applications follow to transfer data/handle errors
* Meaning (semantics) of messages exchanged
* Internet infrastructure such as routing/DNS

**Note**: A router only needs layer 2 *(network interface)* and layer 3 *(Internet)* software to effectively route packets across the network.



### Internet Services and Communication

* The Internet does not provide services itself. It only provides communication, and applications provide all of the services.
* Every Internet communication involves communication amongst application programs
* Internet offers two communication paradigms:
  * Stream paradigm: **TCP**, **transfers a sequence of bytes**
  * Message paradigm: **UDP**, **connectionless state**
* When using TCP:
  * Make sure that the receiver knows where a message ends
  * Read from a socket until the entire message has been acquired
* TCP includes a *push* operation that applications can use to force transmission/delivery
  * Unix convention: automatically *push* for each individual *write* call

#### Client-Server model

* One application acts as **server**, other acts as **client**

  * Server starts execution first, awaits contact
  * Client starts after server, initiates contact (`HelloServer` handshake)

* Once communication is established, data can flow **bi-directionally**

* Server handles many requests at once, is inherently **parallel**

* **The TLS handshake**, captured with `curl`:

  ```
  Alexs-MacBook-Pro:~ alexpotter1$ curl -iv https://www.google.com
  * Rebuilt URL to: https://www.google.com/
  *   Trying 216.58.213.228...
  * TCP_NODELAY set
  * Connected to www.google.com (216.58.213.228) port 443 (#0)
  * ALPN, offering h2
  * ALPN, offering http/1.1
  * Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH
  * successfully set certificate verify locations:
  *   CAfile: /etc/ssl/cert.pem
    CApath: none
  * TLSv1.2 (OUT), TLS handshake, Client hello (1):
  * TLSv1.2 (IN), TLS handshake, Server hello (2):
  * TLSv1.2 (IN), TLS handshake, Certificate (11):
  * TLSv1.2 (IN), TLS handshake, Server key exchange (12):
  * TLSv1.2 (IN), TLS handshake, Server finished (14):
  * TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
  * TLSv1.2 (OUT), TLS change cipher, Client hello (1):
  * TLSv1.2 (OUT), TLS handshake, Finished (20):
  * TLSv1.2 (IN), TLS change cipher, Client hello (1):
  * TLSv1.2 (IN), TLS handshake, Finished (20):
  * SSL connection using TLSv1.2 / ECDHE-ECDSA-AES128-GCM-SHA256
  * ALPN, server accepted to use h2
  * Server certificate:
  *  subject: C=US; ST=California; L=Mountain View; O=Google Inc; CN=www.google.com
  *  start date: Feb 13 10:41:32 2018 GMT
  *  expire date: May  8 10:39:00 2018 GMT
  *  subjectAltName: host "www.google.com" matched cert's "www.google.com"
  *  issuer: C=US; O=Google Inc; CN=Google Internet Authority G2
  *  SSL certificate verify ok.
  * Using HTTP2, server supports multi-use
  * Connection state changed (HTTP/2 confirmed)
  * Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
  * Using Stream ID: 1 (easy handle 0x7f8dde805800)
  > GET / HTTP/2
  > Host: www.google.com
  > User-Agent: curl/7.54.0
  > Accept: */*
  ```

* Uses **sockets** (internal endpoints for sending/receiving data at a single node in a computer network)

####  

#### Application layer protocol

* HTTP

  * HTTP request types: `GET`, `POST`, `PATCH/PUT`, `DELETE`

* Email

  * SMTP

    * Uses the stream paradigm

    * Only transfers textual messages

    * Terminates messages with `<CR><LF>.<CR><LF>`

    * Sends one copy only of a message to a computer

    * <img src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/02/59/SMTP%20filter.png" width="85%">

      â€‹

  * POP3

  * IMAP

  * Non-textual email: **S/MIME**

* FTP

  * Control channel, data channel
  * Server forms data connection for each file transferred
  * Server closes data connection after each transfer is complete

* Remote login: SSH/Telnet

* DNS

  * Hierarchical structure
  * Resolves domain names to IP addresses
  * Resolutions are cached positively/negatively

